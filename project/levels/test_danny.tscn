[gd_scene load_steps=16 format=2]

[ext_resource path="res://icon.png" type="Texture" id=1]
[ext_resource path="res://objects/Board/wall_material.tres" type="Material" id=2]
[ext_resource path="res://assets/meshes/box_inner.glb" type="PackedScene" id=3]
[ext_resource path="res://assets/meshes/hand.tscn" type="PackedScene" id=4]
[ext_resource path="res://objects/Player/Camera.tscn" type="PackedScene" id=5]
[ext_resource path="res://objects/Board/Board.tscn" type="PackedScene" id=6]
[ext_resource path="res://assets/meshes/box_outer.glb" type="PackedScene" id=7]
[ext_resource path="res://assets/meshes/player_mesh.tscn" type="PackedScene" id=8]
[ext_resource path="res://assets/meshes/box_middle.glb" type="PackedScene" id=9]
[ext_resource path="res://objects/Enemy/Enemy.tscn" type="PackedScene" id=10]

[sub_resource type="BoxShape" id=1]

[sub_resource type="CubeMesh" id=2]

[sub_resource type="Environment" id=3]
background_mode = 1
background_color = Color( 0.623529, 0.435294, 1, 1 )
ambient_light_color = Color( 1, 1, 1, 1 )
ambient_light_energy = 2.0
ssao_enabled = true

[sub_resource type="Shader" id=4]
code = "shader_type canvas_item;

uniform float limit: hint_range(0.0,0.5) = 0.2;
uniform float blur: hint_range(0.0,5.0) = 2.0;
uniform float intensity: hint_range (0.0, 0.5) = 0.19;
uniform bool debug = true;

void fragment(){
	
 	if (UV.y<limit){
			
		float _step = smoothstep(UV.y,limit,intensity);
		vec4 color = textureLod(SCREEN_TEXTURE, SCREEN_UV, blur);
		COLOR = color;
		
		if (debug==true){
			COLOR = vec4(1.0,1.0,1.0,1.0)
			}
			
		COLOR.a = _step;
		
	} else if (UV.y > 1.0-limit){
			
		float _step = smoothstep(UV.y,1.0-limit,1.0-intensity);
		vec4 color = textureLod(SCREEN_TEXTURE, SCREEN_UV, blur);
		COLOR = color;
		
		if (debug==true){
			COLOR = vec4(1.0,1.0,1.0,1.0)
			}
		COLOR.a = _step;
			
	}else{
			COLOR.a = 0f; 
		}
}"

[sub_resource type="ShaderMaterial" id=5]
shader = SubResource( 4 )
shader_param/limit = 0.18
shader_param/blur = 2.0
shader_param/intensity = 0.155
shader_param/debug = false

[node name="Spatial" type="Spatial"]

[node name="Board" parent="." instance=ExtResource( 6 )]

[node name="StaticBody" type="StaticBody" parent="Board"]
transform = Transform( 0.093, 0, 0, 0, 0.118, 0, 0, 0, 4.65309, -4.49088, 0, 0.0167924 )
visible = false

[node name="CollisionShape" type="CollisionShape" parent="Board/StaticBody"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Board/StaticBody"]
mesh = SubResource( 2 )
material/0 = ExtResource( 2 )

[node name="StaticBody2" type="StaticBody" parent="Board"]
transform = Transform( 0.093, 0, 0, 0, 0.118, 0, 0, 0, 4.49022, 4.45548, 0, 0 )
visible = false

[node name="CollisionShape" type="CollisionShape" parent="Board/StaticBody2"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Board/StaticBody2"]
mesh = SubResource( 2 )
material/0 = ExtResource( 2 )

[node name="StaticBody3" type="StaticBody" parent="Board"]
transform = Transform( -1.79974e-08, 0, -4.42724, 0, 0.118, 0, 0.093, 0, -4.37114e-08, -0.00880665, 0, -4.39771 )
visible = false

[node name="CollisionShape" type="CollisionShape" parent="Board/StaticBody3"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Board/StaticBody3"]
mesh = SubResource( 2 )
material/0 = ExtResource( 2 )

[node name="StaticBody4" type="StaticBody" parent="Board"]
transform = Transform( -1.81071e-08, 0, -4.45422, 0, 0.118, 0, 0.093, 0, -4.37114e-08, -0.00880665, 0, 4.47029 )
visible = false

[node name="CollisionShape" type="CollisionShape" parent="Board/StaticBody4"]
shape = SubResource( 1 )

[node name="MeshInstance" type="MeshInstance" parent="Board/StaticBody4"]
mesh = SubResource( 2 )
material/0 = ExtResource( 2 )

[node name="player_mesh" parent="Board" instance=ExtResource( 8 )]
transform = Transform( 0.212132, 0, 0.212132, 0, 0.3, 0, -0.212132, 0, 0.212132, 0, 0, 0 )

[node name="Camera" parent="." instance=ExtResource( 5 )]
transform = Transform( 0.707107, -0.40558, 0.579228, 0, 0.819152, 0.573577, -0.707107, -0.40558, 0.579228, 12, 11.091, 12 )
size = 13.0

[node name="Enemy" parent="." instance=ExtResource( 10 )]
transform = Transform( 0.2, 0, 0, 0, 0.2, 0, 0, 0, 0.2, 0.454956, 0.856972, 0 )

[node name="box_outer" parent="." instance=ExtResource( 7 )]
transform = Transform( 0.65, 0, 0, 0, 0.65, 0, 0, 0, 0.65, 0, -2.24902, 0 )

[node name="box_middle" parent="box_outer" instance=ExtResource( 9 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.195068, 0 )

[node name="box_inner" parent="box_outer/box_middle" instance=ExtResource( 3 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.314947, 0 )

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 3 )

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="TiltShift" type="TextureRect" parent="CanvasLayer"]
visible = false
material = SubResource( 5 )
margin_left = -6.9276
margin_top = -9.12834
margin_right = 57.0724
margin_bottom = 54.8717
rect_scale = Vector2( 18.9872, 12.7928 )
texture = ExtResource( 1 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="hand_l" parent="." instance=ExtResource( 4 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.10729, 6.81107 )

[node name="hand_r" parent="." instance=ExtResource( 4 )]
transform = Transform( 0.199984, 0, 0.979799, 0, 1, 0, 0.979799, 0, -0.199984, 6.84557, -0.792515, 0 )
